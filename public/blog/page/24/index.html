
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Zientzilaria</title>
  <meta name="author" content="Paulo Nuin">

  
  <meta name="description" content="Myself, Federico Hoffmann and Juan Opazo are developing a nice cross-platform interface for multidivtime, a program (or a series of programs) used to &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://zientzilaria.heroku.com/blog/page/24">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Zientzilaria" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30723948-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Zientzilaria</a></h1>
  
    <h2>The most influential bioinformatician in the world (TM)</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:zientzilaria.heroku.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/04/15/multigui/">multiGUI</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-04-15T14:00:11-04:00" pubdate data-updated="true">Apr 15<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Myself, <a href="http://biokubuntu.com">Federico Hoffmann</a> and <a href="http://biokubuntu.com">Juan Opazo</a> are developing a nice cross-platform interface for <a href="http://statgen.ncsu.edu/thorne/multidivtime.html">multidivtime</a>, a program (or a series of programs) used to estimate molecular evolution rates and divergence times. We are expecting to have a version released soon. I will post links whenever they are available.</p>

<p>A initial page for <a href="http://genedrift.org/multigui.php">multiGUI </a>is already on GeneDrift.</p>

<p>Update: some <a href="http://genedrift.org/multiguiscreen.php">screenshots were added</a>. As the application is fully cross-platform, Mac, Windows and Linux versions will be available.</p>

<p><strong>Update 2: We are releasing multiGUI (Windows Vista and XP) as a limited beta. If you are interested in trying the software send an email to multigui at genedrift dot org. We are intending to provide a group of 20-30 users the opportunity to try the program, what would allow us to work on future improvements, kill some bugs that weren&#8217;t found in the development/test phase and check for the level of interest of our application in the scientific community.</strong></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/04/14/twitter-updates-for-2008-04-14/">Twitter Updates for 2008-04-14</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-04-14T23:59:59-04:00" pubdate data-updated="true">Apr 14<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li><p>@<a href="http://twitter.com/yokofakun">yokofakun</a> I have almost 300 feeds, and keep adding more. <a href="http://twitter.com/nuin/statuses/789169427">#</a></p></li>
<li><p>Gone swimming &#8230; <a href="http://twitter.com/nuin/statuses/789124547">#</a></p></li>
<li><p>@<a href="http://twitter.com/yokofakun">yokofakun</a> it is pretty good. Usually I find a new feed every week &#8230; <a href="http://twitter.com/nuin/statuses/789124132">#</a></p></li>
<li><p>@<a href="http://twitter.com/yokofakun">yokofakun</a> Me too &#8230; <a href="http://snurl.com/24f2p">http://snurl.com/24f2p</a> <a href="http://twitter.com/nuin/statuses/789118291">#</a></p></li>
<li><p>@<a href="http://twitter.com/rvidal">rvidal</a> I am using the same as yours. <a href="http://twitter.com/nuin/statuses/789094962">#</a></p></li>
<li><p>Twitter Tools installed &#8230; <a href="http://twitter.com/nuin/statuses/789040783">#</a></p></li>
<li><p>Great, I can buy American Idol on the Canadian iTunes Store!!! But I can&#8217;t buy anything else from any country &#8230; <a href="http://twitter.com/nuin/statuses/788937864">#</a></p></li>
<li><p>@<a href="http://twitter.com/attilacsordas">attilacsordas</a> it&#8217;s an OK movie. Interesting to say the least. <a href="http://twitter.com/nuin/statuses/788546091">#</a></p></li>
<li><p>msiexec /i GoogleAppEngine.msi /qb <a href="http://twitter.com/nuin/statuses/788534643">#</a></p></li>
<li><p>finally installed AppEngine on Vista <a href="http://twitter.com/nuin/statuses/788534451">#</a></p></li>
</ul>


<p>Powered by <a href="http://alexking.org/projects/wordpress">Twitter Tools</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/04/14/twitter/">Twitter</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-04-14T15:39:23-04:00" pubdate data-updated="true">Apr 14<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://pimm.wordpress.com/2008/04/14/follow-biotecher-a-solution-to-find-all-biotwitters-in-1-place/">Attila Csordas</a> created @biotecher in Twitter so we, you, everyone can follow what every other bioinformatician, scientist, human being is doing. Just join <a href="http://twitter.com">Twitter</a> and follow <a href="http://twitter.com/biotecher">@biotecher</a>, and <a href="http://twitter.com/nuin">me</a> if you want.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/04/14/python-and-appengine-in-vista/">Python and AppEngine in Vista</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-04-14T08:55:54-04:00" pubdate data-updated="true">Apr 14<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I had problems installing Google&#8217;s AppEngine in Vista. I had Python 2.5.1 installed in my machine but every time I tried to install the msi package it failed, claiming that Python was not present, even though C:\Python25 was in the path. AppEngine issues site did not help much either, the &#8220;solution&#8221; listed there was to make sure Python was in the path.</p>

<p>So, I decided to start over. I removed Python (and ActiveState Python, which I installed before to see if AppEngine would work) and re-installed it, or tried to. Strangely, Python&#8217;s msi package was installing it in the C drive root, not under Python25. For half an hour I tested all possible combinations, versions and tricks to have it installed in the proper directory/folder. Then I remembered <a href="http://technet2.microsoft.com/windowsserver/en/library/9361d377-9011-4e21-8011-db371fa220ba1033.mspx?mfr=true">msiexec</a>, a command line tool that runs msi packages. Running msiexec with no parameters shows a window with options, but basically <code>/i</code> is the the only required. <code>/i</code> tells msiexec the input package, while &#8216;code>/qb` make the installation quiet and with a basic interface. msiexec worked flawlessly and then Python was in its right place.</p>

<p><code>msiexec /i python-2.5.2.msi TARGETDIR="C:\Python25" /qb</code></p>

<p>Then the same &#8220;trick&#8221; was used with AppEngine, but without a TARGETDIR. Bingo, it installed perfectly (I am assuming that).</p>

<p>Now, I just have to wait for my AppEngine account.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/04/13/twitter-updates-for-2008-04-13/">Twitter Updates for 2008-04-13</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-04-13T23:59:59-04:00" pubdate data-updated="true">Apr 13<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li><p>@<a href="http://twitter.com/neilfws">neilfws</a> I am counting on that &#8230; fingers crossed <a href="http://twitter.com/nuin/statuses/788494339">#</a></p></li>
<li><p>@<a href="http://twitter.com/zzgavin">zzgavin</a> apparently &#8230; <a href="http://twitter.com/nuin/statuses/788432971">#</a></p></li>
<li><p>@<a href="http://twitter.com/freesci">freesci</a> It was strange. I installed fine on my iMac. On Vista the installation fails. I still don&#8217;t have an account. <a href="http://twitter.com/nuin/statuses/788397837">#</a></p></li>
<li><p>@<a href="http://twitter.com/yokofakun">yokofakun</a> Yep, I have that, but no expert so far. In VS I sually program VB and VC++. I am trying to get C# and IronPython <a href="http://twitter.com/nuin/statuses/788388717">#</a></p></li>
<li><p>@<a href="http://twitter.com/mndoci">mndoci</a> I should to that, but I am addicted to Visual Studio &#8230; we all have our bad vices &#8230; <a href="http://twitter.com/nuin/statuses/788387341">#</a></p></li>
<li><p>@<a href="http://twitter.com/freesci">freesci</a> Do you have your account? <a href="http://twitter.com/nuin/statuses/788385623">#</a></p></li>
<li><p>@<a href="http://twitter.com/freesci">freesci</a> I even installed ActiveState Python to check. Python 2.5.2 is in the path and everything else finds it. <a href="http://twitter.com/nuin/statuses/788384958">#</a></p></li>
<li><p>@<a href="http://twitter.com/freesci">freesci</a> I tried to install on my Vista machine and it keeps complaining about the &#8220;lack&#8221; of Python. <a href="http://twitter.com/nuin/statuses/788384707">#</a></p></li>
<li><p>@<a href="http://twitter.com/mndoci">mndoci</a> time is the key word here <a href="http://twitter.com/nuin/statuses/788330648">#</a></p></li>
<li><p>@<a href="http://twitter.com/mndoci">mndoci</a> I have been to Uruguay and to the border of Bolivia, but Buenos Aires may be too good to miss. <a href="http://twitter.com/nuin/statuses/788314605">#</a></p></li>
<li><p>@<a href="http://twitter.com/mndoci">mndoci</a> 29 years of Brazil is enough for me. Now only for quick visits. But I would love to go to Peru, Argentina and Chile. <a href="http://twitter.com/nuin/statuses/788312175">#</a></p></li>
<li><p>Will the Orange and Black have a better fate today? <a href="http://twitter.com/nuin/statuses/788311759">#</a></p></li>
<li><p>@<a href="http://twitter.com/neilfws">neilfws</a> South America is good for a brief period and just for tourism. Apart from that &#8230; The flora and fauna are great anyway. <a href="http://twitter.com/nuin/statuses/788116199">#</a></p></li>
<li><p>Gave up AppEngine on Windows &#8230; frustrating &#8230; <a href="http://twitter.com/nuin/statuses/788082599">#</a></p></li>
</ul>


<p>Powered by <a href="http://alexking.org/projects/wordpress">Twitter Tools</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/03/30/merging-sequences-from-a-pfam-alignment-using-sets-part-ii/">Merging sequences from a Pfam alignment: using sets, part II</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-03-30T19:30:49-04:00" pubdate data-updated="true">Mar 30<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Mike and Luke left comments and suggestions on how to attack the problem
from the previous entry. I copied their comments here in order to
maintain code formatting a little bit better (comments do not have code
highlighting and formatting). Mike: Why not build a dictionary of the
fasta data keyed by protein ID. The value of each dictionary entry would
be a list of (name,sequence) tuples. Then iterate over the dictionary
items and build the output list from dictionary entries of length == 2.
Obviously, I don’t have any data sets to test it on, but something like
this might work:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">merge_seqs</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">):</span>
</span><span class='line'>  <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
</span><span class='line'>  <span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">chain</span>
</span><span class='line'>  <span class="n">data</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
</span><span class='line'>  
</span><span class='line'>  <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">chain</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">):</span>
</span><span class='line'>      <span class="n">ident</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="err">’</span><span class="o">|</span><span class="s">&#39;)+1:i.name.find(’/&#39;</span><span class="p">)]</span>
</span><span class='line'>      <span class="n">data</span><span class="p">[</span><span class="n">ident</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">sequence</span><span class="p">))</span>
</span><span class='line'>      <span class="n">format</span> <span class="o">=</span> <span class="err">“</span><span class="o">%</span><span class="n">s</span><span class="o">-%</span><span class="n">s</span><span class="o">-</span>\<span class="o">&gt;%</span><span class="n">d</span>\\<span class="n">n</span><span class="o">%</span><span class="n">s</span><span class="o">%</span><span class="n">s</span><span class="err">”</span>
</span><span class='line'>      <span class="n">flist</span> <span class="o">=</span> <span class="p">[</span> <span class="p">]</span>
</span><span class='line'>      
</span><span class='line'>      <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
</span><span class='line'>          <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span class='line'>              <span class="n">jname</span><span class="p">,</span><span class="n">jseq</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span class='line'>              <span class="n">kname</span><span class="p">,</span><span class="n">kseq</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span class='line'>              <span class="n">flist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fmt</span> <span class="o">%</span> <span class="p">(</span><span class="n">jname</span><span class="p">,</span> <span class="n">kname</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">jseq</span><span class="p">),</span> <span class="n">jseq</span><span class="p">,</span> <span class="n">kseq</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="n">flist</span>
</span></code></pre></td></tr></table></div></figure>


<p>Luke: Are there duplicate IDs in a single
file? If not, no reason to perform the intersection twice (once by set,
once by nested loop). Sets and dictionaries are both hashes, so just
remember the instances with the id:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">merge_seqs</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">):</span>
</span><span class='line'>  <span class="n">first</span><span class="p">,</span> <span class="n">second</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(),</span> <span class="nb">dict</span><span class="p">()</span>
</span><span class='line'>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data1</span><span class="p">:</span>
</span><span class='line'>      <span class="n">first</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="err">’</span><span class="o">|</span><span class="s">&#39;) + 1:i.name.find(’/&#39;</span><span class="p">)]]</span> <span class="o">=</span> <span class="n">i</span>
</span><span class='line'>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data2</span><span class="p">:</span>
</span><span class='line'>      <span class="n">second</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="err">’</span><span class="o">|</span><span class="s">&#39;) + 1:i.name.find(’/&#39;</span><span class="p">)]]</span> <span class="o">=</span> <span class="n">i</span>
</span><span class='line'>      
</span><span class='line'>  <span class="n">shared_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">first</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">second</span><span class="p">))</span>
</span><span class='line'>  
</span><span class='line'>  <span class="n">flist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">shared_ids</span><span class="p">:</span>
</span><span class='line'>      <span class="n">j</span> <span class="o">=</span> <span class="n">first</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span class='line'>      <span class="n">k</span> <span class="o">=</span> <span class="n">second</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span class='line'>      <span class="n">tempname</span> <span class="o">=</span> <span class="n">j</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="err">‘</span><span class="o">-</span><span class="err">’</span> <span class="o">+</span> <span class="n">k</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="err">‘</span><span class="o">-</span>\<span class="o">&gt;</span><span class="err">’</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">j</span><span class="o">.</span><span class="n">sequence</span><span class="p">))</span>
</span><span class='line'>      <span class="n">tempseq</span> <span class="o">=</span> <span class="n">j</span><span class="o">.</span><span class="n">sequence</span> <span class="o">+</span> <span class="n">k</span><span class="o">.</span><span class="n">sequence</span>
</span><span class='line'>      <span class="n">flist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tempname</span> <span class="o">+</span> <span class="err">‘</span>\\<span class="n">n</span><span class="err">’</span> <span class="o">+</span> <span class="n">tempseq</span><span class="p">)</span>
</span><span class='line'>  
</span><span class='line'>  <span class="k">return</span> <span class="n">flist</span>
</span></code></pre></td></tr></table></div></figure>


<p>If there are duplicate IDs in a file, and you want the behaviour of your
original script of giving every combination <em>between</em> files, how about
a dictionary of lists and the cross-product of j &amp; k? (I’m going to use
python2.5’s <code>collections.defaultdict</code>, if you’re on an earlier version use
.<code>setdefault</code> . The cross product brings back a nested loop, but it’s only
over values we want rather than the whole datasets.)</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">merge_seqs</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">):</span>
</span><span class='line'>      <span class="n">first</span><span class="p">,</span> <span class="n">second</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">),</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
</span><span class='line'>  
</span><span class='line'>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data1</span><span class="p">:</span>
</span><span class='line'>      <span class="n">first</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="err">’</span><span class="o">|</span><span class="s">&#39;)+1:i.name.find(’/&#39;</span><span class="p">)]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span class='line'>      
</span><span class='line'>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data2</span><span class="p">:</span>
</span><span class='line'>      <span class="n">second</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="err">’</span><span class="o">|</span><span class="s">&#39;)+1:i.name.find(’/&#39;</span><span class="p">)]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span class='line'>      
</span><span class='line'>  <span class="n">shared_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">first</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">second</span><span class="p">))</span>
</span><span class='line'>  <span class="n">flist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">shared_ids</span><span class="p">:</span>
</span><span class='line'>      <span class="n">cross</span> <span class="o">=</span> <span class="p">[(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">first</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">second</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
</span><span class='line'>      
</span><span class='line'>  <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="n">cross</span><span class="p">:</span>
</span><span class='line'>      <span class="n">tempname</span> <span class="o">=</span> <span class="n">j</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="err">‘</span><span class="o">-</span><span class="err">’</span> <span class="o">+</span> <span class="n">k</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="err">‘</span><span class="o">-</span>\<span class="o">&gt;</span><span class="err">’</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">j</span><span class="o">.</span><span class="n">sequence</span><span class="p">))</span>
</span><span class='line'>      <span class="n">tempseq</span> <span class="o">=</span> <span class="n">j</span><span class="o">.</span><span class="n">sequence</span> <span class="o">+</span> <span class="n">k</span><span class="o">.</span><span class="n">sequence</span>
</span><span class='line'>      <span class="n">flist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tempname</span> <span class="o">+</span> <span class="err">‘</span>\\<span class="n">n</span><span class="err">’</span> <span class="o">+</span> <span class="n">tempseq</span><span class="p">)</span>
</span><span class='line'>  
</span><span class='line'>  <span class="k">return</span> <span class="n">flist</span>
</span></code></pre></td></tr></table></div></figure>


<p>And
if you want combinations from within a file as well, just use one
dictionary of lists and cross each list value with itself, excluding
identical elements:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">cross</span> <span class="o">=</span> <span class="p">[(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="n">b</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>To your
question of more directly creating the sets of names, can’t be much more
direct, but perhaps more concise using a generator (or list, with the
extra cost) comprehension:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">myset1</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="err">…</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data1</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Could do equivalently for the
dict-based first example above, noting that the dict() constructor can
take a sequence of (key, value) tuples. This would not work for the
<code>defaultdict</code> or <code>setdefault</code> based version.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/03/29/earth-hour/">Earth hour</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-03-29T10:12:06-04:00" pubdate data-updated="true">Mar 29<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Some questions about the Earth hour (8pm, Saturday March 29th, 2008):</p>

<ul>
<li>will the people that take the elevator down one floor turn off the lights?</li>
<li>will the people that, even with four functional limbs, not carrying anything, and between the ages of 15-50, use the button to open all kinds of doors turn off the lights?</li>
<li>will the people that leave the lights on in the meeting room after the meeting turn off the lights?</li>
<li>will the guy/gal on my floor that leave the light on in the chute room turn off the lights?</li>
<li>will everyone that printed millions of pamphlets, fliers, banners, etc announcing the Earth hour turn off the lights?</li>
<li>will the guy who decides the fare price of subway/bus/streetcar in Toronto turn off the lights? (Just a comparison: in Toronto a single fare costs CDN$ 2.75, ten fares are CDN$ 22.50. In Madrid, a single fare is one euro and ten trips are  6.70)</li>
</ul>


<p>I will update whenever a new question pops up.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/03/28/merging-sequences-from-a-pfam-alignment-using-sets/">Merging sequences from a Pfam alignment: using sets</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-03-28T20:58:24-04:00" pubdate data-updated="true">Mar 28<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>A colleague came with a &#8220;problem&#8221;: what would be the most efficient way
to merge <a href="http://pfam.sanger.ac.uk/">Pfam</a> alignments? He had FASTA
files containing sequences and he wanted to find identical IDs in two
files and merge the related sequences from different domains of the same
protein. His C++ approach was taking too long to run so I jumped in to
help with some Python tricks.</p>

<p>Fasta headers of Pfam alignments look like
this <code>&gt;P00526.2|SRC_RSVP/147-229</code> where the first section, before the
pipe, is the protein family, the section between the pipe and the slash
is the protein ID and the after the slash are the start and end
positions. Basically we want to match the protein ID, between | and /,
which is the only section that should not change from one alignment from
the other, if there are similar sequences in both files. His dataset
size was around 8000 FASTA files and he wanted to compare
all-versus-all.</p>

<p>The first idea that comes to mind is to read the two
files and basically run nested loops checking for matches between two
sequence names. Simple and easy. But it would be good to find something
else to do in the meantime, instead of checking for its progress.
Another idea, to simplify the process, is to read both files, extract
the protein IDs and check for the intersection of the two sets of IDs
and then just extract the sequences from a list of matches.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">merge_seqs</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">):</span>
</span><span class='line'>  <span class="n">myset1</span><span class="p">,</span> <span class="n">myset2</span> <span class="o">=</span> <span class="n">Set</span><span class="p">([]),</span> <span class="n">Set</span><span class="p">([])</span>
</span><span class='line'>  
</span><span class='line'>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data1</span><span class="p">:</span>
</span><span class='line'>      <span class="n">myset1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;|&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)])</span>
</span><span class='line'>  
</span><span class='line'>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data2</span><span class="p">:</span>
</span><span class='line'>      <span class="n">myset2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;|&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)])</span>
</span><span class='line'>      
</span><span class='line'>  <span class="n">mylist</span> <span class="o">=</span> <span class="n">Set</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">myset1</span><span class="p">,</span> <span class="n">myset2</span><span class="p">)</span>
</span><span class='line'>  <span class="n">flist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'>  
</span><span class='line'>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">mylist</span><span class="p">:</span>
</span><span class='line'>      <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">data1</span><span class="p">:</span>
</span><span class='line'>          <span class="k">if</span> <span class="n">j</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">j</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;|&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
</span><span class='line'>          <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data2</span><span class="p">:</span>
</span><span class='line'>              <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;|&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">k</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)]</span> <span class="o">==</span> <span class="n">j</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">j</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;|&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)]:</span>
</span><span class='line'>                  <span class="n">tempname</span> <span class="o">=</span> <span class="n">j</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&#39;-&#39;</span> <span class="o">+</span> <span class="n">k</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&#39;-\&gt;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">j</span><span class="o">.</span><span class="n">sequence</span><span class="p">))</span>
</span><span class='line'>                  <span class="n">tempseq</span> <span class="o">=</span> <span class="n">j</span><span class="o">.</span><span class="n">sequence</span> <span class="o">+</span> <span class="n">k</span><span class="o">.</span><span class="n">sequence</span>
</span><span class='line'>                  <span class="n">flist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tempname</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\\</span><span class="s">n&#39;</span> <span class="o">+</span> <span class="n">tempseq</span><span class="p">)</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">flist</span>
</span></code></pre></td></tr></table></div></figure>


<p>This
is the function that matches the sequence IDs. As we are reading the
FASTA file with the functions/classes in the <code>fasta</code> module there is
no* direct way to transform the list of sequence names into a set, that
would make easier to extract the intersection between two sets of IDs
from distinct files. In the above function, <code>data1</code> and <code>data2</code> are
instances of the <code>fasta</code> class, and we read these lists and add the
<code>fasta.name</code> to a couple of sets and get the intersection of them. The
<code>intersection</code> method returns a list that we use in the nested loops to
find the matching sequences, as we need to merge them, we add both names
and residues. Simple and easy. All merged sequences, and their
respective merged names, are appended to a list that is returned at the
end of the function. *<em>if there is a more direct way, just let me know</em></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/03/28/awk-and-sed-sed-and-awk/">Awk and sed, Sed and awk</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-03-28T09:44:54-04:00" pubdate data-updated="true">Mar 28<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I would like to thank Lee E. McMahon, Alfred Aho, Peter Weinberger and Brian Kernighan. Thanks a lot.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/03/26/ride-to-conquer-cancer/">Ride to Conquer Cancer</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-03-26T18:53:00-04:00" pubdate data-updated="true">Mar 26<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>My supervisor, Elisabeth Tillier, is part of a team on the Ride to Conquer Cancer benefiting the Princess Margaret Hospita, Toronto, Canada. The ride is a beautiful event where people ride their bikes from Toronto to Niagara Falls, during two days in June.</p>

<p>If you want to donate there is an easy way by going to <a href="http://www.conquercancer.ca/site/TR/Events/Toronto2008?px=1548939&amp;pg=personal&amp;fr_id=1201&amp;et=E-PMVS5Y4td-3Bf4EqAgug..&amp;s_tafId=96521">Elisabeth&#8217;s page on the ride website</a>. She is riding for her sister in law Carine, which was diagnosed an year ago with breast cancer, just after giving birth to her second son. Every little counts.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/25/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/23/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/06/03/installing-circos-on-os-x/">Installing Circos on OS X</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/04/09/new-blog/">New blog</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/02/23/scientists-are-human-beings/">Scientists are human beings</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/02/16/a-plea-to-mankind-news-outlets-and-even-scientists/">A plea to mankind, news outlets and even scientists</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/02/15/there-are-idiots-everywhere/">There are idiots everywhere &#8230;</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Github Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/nuin">@nuin</a> on Github
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'nuin',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("nuin", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/nuin" class="twitter-follow-button" data-show-count="false">Follow @nuin</a>
  
</section>


<section>
  <h1>On Delicious</h1>
  <div id="delicious"></div>
  <script type="text/javascript" src="http://feeds.delicious.com/v2/json/nuin?count=3&amp;sort=date&amp;callback=renderDeliciousLinks"></script>
  <p><a href="http://delicious.com/nuin">My Delicious Bookmarks &raquo;</a></p>
</section>


  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Paulo Nuin -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'zientzilaria';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
