
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Splitting a multiple sequence FASTA file, making it better - Zientzilaria</title>
  <meta name="author" content="Paulo Nuin">

  
  <meta name="description" content="On the last entry we saw how to split a multiple FASTA file with our
previous FASTA module. The previous script saved a sequence per file,
where the &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://zientzilaria.genedrift.org/temp/2007-10-09-splitting-a-multiple-sequence-fasta-file-making-it-better.html">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Zientzilaria" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Zientzilaria</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:zientzilaria.genedrift.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Splitting a multiple sequence FASTA file, making it better</h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-10-09T16:13:30-04:00" pubdate data-updated="true">Oct 9<span>th</span>, 2007</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>On the last entry we saw how to split a multiple FASTA file with our
previous FASTA module. The previous script saved a sequence per file,
where the filename was identical to the original file with the exception
of a number added to the end. Let&#8217;s say we have the file mysequences.fa,
our script would save mysequences.fa1, mysequences.fa2, &#8230;,
mysequences.fa<em>n</em>. This is fine, but we need to make it better. Ideally
we should ask the user for a prefix or a filename for the output. On the
other hand, it would be an improvement if we put the number before the
file tag. We will do that in a couple of lines. First we need to find
the tag and the actual filename. We could go through a longer route if
we used the <code>find</code> method to find the dot and then extract portions of
the string to the actual name and tag. But we can use <code>split</code>
[sourcecode language=&#8217;python&#8217;]file = sys.argv[1] temp = file.split(&#8216;.&#8217;)
filename = temp[0] tag = temp[1][/sourcecode] We split the original
string at the dot and the first item or the returned list is the file
name and the second item is the tag. Now we just need to change a little
bit the code for the output and we are done. The final script is
[sourcecode language=&#8217;python&#8217;]#!/usr/bin/env python import sys import
fasta file = sys.argv[1] temp = file.split(&#8216;.&#8217;) filename = temp[0] tag =
temp[1] sequences = fasta.read_fasta(open(file, &#8216;r&#8217;).readlines()) count
= 1 for i in sequences: #this is the only different line output =
open(filename+&#8217;_&#8217;+str(count)+&#8217;.&#8217;+tag, &#8216;w&#8217;) output.write(i.name+&#8217;\n&#8217;)
output.write(i.sequence) count += 1[/sourcecode]</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">admin</span></span>

      








  


<time datetime="2007-10-09T16:13:30-04:00" pubdate data-updated="true">Oct 9<span>th</span>, 2007</time>
      

<span class="categories">
  
    Liquid error: undefined method `sort!' for nil:NilClass
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://zientzilaria.genedrift.org/temp/2007-10-09-splitting-a-multiple-sequence-fasta-file-making-it-better.html" data-via="" data-counturl="http://zientzilaria.genedrift.org/temp/2007-10-09-splitting-a-multiple-sequence-fasta-file-making-it-better.html" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
</div>

    
    <p class="meta">
      
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2011/09/06/goodbye-and-so-long/">Goodbye and so long</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/03/06/testing-feed/">Testing feed</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/02/23/scientists-are-human-beings/">Scientists are human beings</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/02/16/a-plea-to-mankind-news-outlets-and-even-scientists/">A plea to mankind, news outlets and even scientists</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/02/15/there-are-idiots-everywhere/">There are idiots everywhere ...</a>
      </li>
    
  </ul>
</section>




  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Paulo Nuin -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
